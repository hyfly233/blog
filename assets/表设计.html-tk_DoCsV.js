import{_ as n,c as l,f as a,o as e}from"./app-chPKMbRn.js";const p={};function o(i,s){return e(),l("div",null,s[0]||(s[0]=[a(`<h2 id="建表基础" tabindex="-1"><a class="header-anchor" href="#建表基础"><span>建表基础</span></a></h2><p>使用 CREATE TABLE 语句在 Doris 中创建一个表，也可以使用 CREATE TABKE LIKE 或 CREATE TABLE AS 子句从另一个表派生表定义</p><h3 id="create-table" tabindex="-1"><a class="header-anchor" href="#create-table"><span>CREATE TABLE</span></a></h3><p>基础建表语句</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#81A1C1;">CREATE</span><span style="color:#81A1C1;"> TABLE</span><span style="color:#D8DEE9FF;"> [IF NOT EXISTS] [database.]</span><span style="color:#81A1C1;">table</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    column_definition_list</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    [, index_definition_list]</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">[engine_type]</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">[keys_type]</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">[table_comment]</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">[partition_info]</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">distribution_desc</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">[rollup_list]</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">[properties]</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">[extra_properties]</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="column-definition-list" tabindex="-1"><a class="header-anchor" href="#column-definition-list"><span>column_definition_list</span></a></h4><p>列定义列表 column_definition[, column_definition]</p><ul><li><p>column_definition 列定义</p><p>column_name column_type [KEY] [aggr_type] [NULL] [AUTO_INCREMENT(auto_inc_start_value)] [default_value] [on update current_timestamp] [column_comment]</p><ul><li>column_type 列类型</li><li>aggr_type 聚合类型</li></ul><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#D8DEE9FF;">k1 </span><span style="color:#81A1C1;">TINYINT</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">k2 </span><span style="color:#81A1C1;">DECIMAL</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10</span><span style="color:#D8DEE9FF;">,</span><span style="color:#B48EAD;">2</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">DEFAULT</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">10.5</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">k4 </span><span style="color:#81A1C1;">BIGINT</span><span style="color:#81A1C1;"> NULL</span><span style="color:#81A1C1;"> DEFAULT</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1000</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;"> COMMENT </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">This is column k4</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">v1 </span><span style="color:#81A1C1;">VARCHAR</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">REPLACE</span><span style="color:#81A1C1;"> NOT NULL</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">v2 BITMAP BITMAP_UNION,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">v3 HLL HLL_UNION,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">v4 </span><span style="color:#81A1C1;">INT</span><span style="color:#D8DEE9FF;"> SUM </span><span style="color:#81A1C1;">NOT NULL</span><span style="color:#81A1C1;"> DEFAULT</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;"> COMMENT </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">This is column v4</span><span style="color:#ECEFF4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">dt </span><span style="color:#81A1C1;">datetime</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">6</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">default</span><span style="color:#88C0D0;"> current_timestamp</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">6</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">on</span><span style="color:#81A1C1;"> update</span><span style="color:#88C0D0;"> current_timestamp</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">6</span><span style="color:#D8DEE9FF;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>default_value 列默认值</li><li>on update current_timestamp 是否在该行有列更新时将该列的值更新为当前时间 (current_timestamp)。该特性只能在开启了 Merge-on-Write 的 Unique 表上使用，开启了这个特性的列必须声明默认值，且默认值必须为 current_timestamp。如果此处声明了时间戳的精度，则该列默认值中的时间戳精度必须与该处的时间戳精度相同</li></ul></li></ul><h4 id="index-definition-list" tabindex="-1"><a class="header-anchor" href="#index-definition-list"><span>index_definition_list</span></a></h4><p>索引列表定义 index_definition[, index_definition]</p><ul><li><p>index_definition 索引定义</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#81A1C1;">INDEX</span><span style="color:#D8DEE9FF;"> index_name (col_name) [USING INVERTED] COMMENT </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">xxxxxx</span><span style="color:#ECEFF4;">&#39;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="engine-type" tabindex="-1"><a class="header-anchor" href="#engine-type"><span>engine_type</span></a></h4><p>表引擎类型，如 OLAP</p><h4 id="keys-type" tabindex="-1"><a class="header-anchor" href="#keys-type"><span>keys_type</span></a></h4><p>数据模型 key_type(col1, col2, ...)</p><p>key_type 支持以下模型：</p><ul><li>DUPLICATE KEY（默认）：其后指定的列为排序列。</li><li>AGGREGATE KEY：其后指定的列为维度列。</li><li>UNIQUE KEY：其后指定的列为主键列。</li></ul><p>注：当表属性enable_duplicate_without_keys_by_default = true时，默认创建没有排序列的 Duplicate 表</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#D8DEE9FF;">DUPLICATE </span><span style="color:#81A1C1;">KEY</span><span style="color:#D8DEE9FF;">(col1, col2),</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">AGGREGATE</span><span style="color:#81A1C1;"> KEY</span><span style="color:#D8DEE9FF;">(k1, k2, k3),</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">UNIQUE</span><span style="color:#81A1C1;"> KEY</span><span style="color:#D8DEE9FF;">(k1, k2)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="table-comment" tabindex="-1"><a class="header-anchor" href="#table-comment"><span>table_comment</span></a></h4><p>表注释</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#D8DEE9FF;">COMMENT </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">COMMENT</span><span style="color:#ECEFF4;">&quot;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="partition-info" tabindex="-1"><a class="header-anchor" href="#partition-info"><span>partition_info</span></a></h4><p>分区信息</p><h5 id="less-than" tabindex="-1"><a class="header-anchor" href="#less-than"><span>LESS THAN</span></a></h5><p>仅定义分区上界。下界由上一个分区的上界决定</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#81A1C1;">PARTITION</span><span style="color:#81A1C1;"> BY</span><span style="color:#81A1C1;"> RANGE</span><span style="color:#D8DEE9FF;">(col1[, col2, ...])</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">    PARTITION</span><span style="color:#D8DEE9FF;"> partition_name1 </span><span style="color:#81A1C1;">VALUES</span><span style="color:#D8DEE9FF;"> LESS THAN MAXVALUE|(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">value1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">value2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, ...),</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">    PARTITION</span><span style="color:#D8DEE9FF;"> partition_name2 </span><span style="color:#81A1C1;">VALUES</span><span style="color:#D8DEE9FF;"> LESS THAN MAXVALUE|(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">value1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">value2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, ...)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="fixed-range" tabindex="-1"><a class="header-anchor" href="#fixed-range"><span>FIXED RANGE</span></a></h5><p>定义分区的左闭右开区间</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#81A1C1;">PARTITION</span><span style="color:#81A1C1;"> BY</span><span style="color:#81A1C1;"> RANGE</span><span style="color:#D8DEE9FF;">(col1[, col2, ...])</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">    PARTITION</span><span style="color:#D8DEE9FF;"> partition_name1 </span><span style="color:#81A1C1;">VALUES</span><span style="color:#D8DEE9FF;"> [(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">k1-lower1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">k2-lower1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">k3-lower1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,...), (</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">k1-upper1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">k2-upper1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">k3-upper1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, ...)),</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">    PARTITION</span><span style="color:#D8DEE9FF;"> partition_name2 </span><span style="color:#81A1C1;">VALUES</span><span style="color:#D8DEE9FF;"> [(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">k1-lower1-2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">k2-lower1-2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, ...), (</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">k1-upper1-2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">, MAXVALUE, ))</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="multi-range" tabindex="-1"><a class="header-anchor" href="#multi-range"><span>MULTI RANGE</span></a></h5><p>批量创建 RANGE 分区，定义分区的左闭右开区间，设定时间单位和步长，时间单位支持年、月、日、周和小时</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#81A1C1;">PARTITION</span><span style="color:#81A1C1;"> BY</span><span style="color:#81A1C1;"> RANGE</span><span style="color:#D8DEE9FF;">(col)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">   FROM</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2000-11-14</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">TO</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2021-11-14</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) INTERVAL </span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;"> YEAR</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">   FROM</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2021-11-14</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">TO</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2022-11-14</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) INTERVAL </span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;"> MONTH</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">   FROM</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2022-11-14</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">TO</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2023-01-03</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) INTERVAL </span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;"> WEEK</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">   FROM</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2023-01-03</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">TO</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2023-01-14</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) INTERVAL </span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;"> DAY</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">PARTITION</span><span style="color:#81A1C1;"> BY</span><span style="color:#81A1C1;"> RANGE</span><span style="color:#D8DEE9FF;">(int_col)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">    FROM</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">TO</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#B48EAD;">100</span><span style="color:#D8DEE9FF;">) INTERVAL </span><span style="color:#B48EAD;">10</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="distribution-desc" tabindex="-1"><a class="header-anchor" href="#distribution-desc"><span>distribution_desc</span></a></h4><p>定义数据分桶</p><ul><li>Hash 分桶：DISTRIBUTED BY HASH (k1[,k2 ...]) [BUCKETS num|auto] 说明： 使用指定的 key 列进行哈希分桶。</li><li>Random 分桶： DISTRIBUTED BY RANDOM [BUCKETS num|auto] 说明： 使用随机数进行分桶。</li></ul><h4 id="rollup-list" tabindex="-1"><a class="header-anchor" href="#rollup-list"><span>rollup_list</span></a></h4><p>建表的同时可创建多个物化视图（ROLLUP） ROLLUP (rollup_definition[, rollup_definition, ...])</p><ul><li><p>rollup_definition</p><p>rollup_name (col1[, col2, ...]) [DUPLICATE KEY(col1[, col2, ...])] [PROPERTIES(&quot;key&quot; = &quot;value&quot;)]</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#81A1C1;">ROLLUP</span><span style="color:#D8DEE9FF;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    r1 (k1, k3, v1, v2),</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    r2 (k1, v1)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="properties" tabindex="-1"><a class="header-anchor" href="#properties"><span>properties</span></a></h4><p>设置表属性</p><ul><li><p>replication_num</p><p>副本数。默认副本数为 3。如果 BE 节点数量小于 3，则需指定副本数小于等于 BE 节点数量。在 0.15 版本后，该属性将自动转换成 replication_allocation 属性，如：<code>&quot;replication_num&quot; = &quot;3&quot;</code> 会自动转换成 <code>&quot;replication_allocation&quot; = &quot;tag.location.default:3&quot;</code></p></li><li><p>replication_allocation</p><p>根据 Tag 设置副本分布情况。该属性可以完全覆盖 replication_num 属性的功能。</p></li><li><p>min_load_replica_num</p><p>设定数据导入成功所需的最小副本数，默认值为 -1。当该属性小于等于 0 时，表示导入数据仍需多数派副本成功。</p></li><li><p>is_being_synced</p><p>用于标识此表是否是被 CCR 复制而来并且正在被 syncer 同步，默认为 false。</p><p>如果设置为 true：colocate_with，storage_policy 属性将被擦除，dynamic partition，auto bucket功能将会失效，即在show create table中显示开启状态，但不会实际生效。</p><p>当 is_being_synced 被设置为 false 时，这些功能将会恢复生效。</p><p>这个属性仅供 CCR 外围模块使用，在 CCR 同步的过程中不要手动设置。</p></li><li><p>storage_medium / storage_cooldown_time</p><p>数据存储介质。storage_medium 用于声明表数据的初始存储介质，而 storage_cooldown_time 用于设定到期时间。示例：</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">storage_medium</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">SSD</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">storage_cooldown_time</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">2020-11-20 00:00:00</span><span style="color:#ECEFF4;">&quot;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>这个示例表示数据存放在 SSD 中，并且在 2020-11-20 00:00:00 到期后，会自动迁移到 HDD 存储上。</p></li><li><p>colocate_with</p><p>当需要使用 Colocation Join 功能时，使用这个参数设置 Colocation Group。</p><p>&quot;colocate_with&quot; = &quot;group1&quot;</p></li><li><p>bloom_filter_columns</p><p>用户指定需要添加 Bloom Filter 索引的列名称列表。各个列的 Bloom Filter 索引是独立的，并不是组合索引。</p><p>&quot;bloom_filter_columns&quot; = &quot;k1, k2, k3&quot;</p></li><li><p>compression</p><p>Doris 表的默认压缩方式是 LZ4。1.1 版本后，支持将压缩方式指定为 ZSTD 以获得更高的压缩比。</p><p>&quot;compression&quot;=&quot;zstd&quot;</p></li><li><p>function_column.sequence_col</p><p>当使用 Unique Key 模型时，可以指定一个 Sequence 列，当 Key 列相同时，将按照 Sequence 列进行 REPLACE(较大值替换较小值，否则无法替换)</p><p>function_column.sequence_col 用来指定 sequence 列到表中某一列的映射，该列可以为整型和时间类型（DATE、DATETIME），创建后不能更改该列的类型。如果设置了 function_column.sequence_col, function_column.sequence_type 将被忽略。</p><p>&quot;function_column.sequence_col&quot; = &#39;column_name&#39;</p></li><li><p>function_column.sequence_type</p><p>当使用 Unique Key 模型时，可以指定一个 Sequence 列，当 Key 列相同时，将按照 Sequence 列进行 REPLACE(较大值替换较小值，否则无法替换)</p><p>这里我们仅需指定顺序列的类型，支持时间类型或整型。Doris 会创建一个隐藏的顺序列。</p><p>&quot;function_column.sequence_type&quot; = &#39;Date&#39;</p></li><li><p>enable_unique_key_merge_on_write</p><p>Unique 表是否使用 Merge-on-Write 实现。 该属性在 2.1 版本之前默认关闭，从 2.1 版本开始默认开启。</p></li><li><p>light_schema_change</p><p>是否使用 Light Schema Change 优化。</p><p>如果设置成 true, 对于值列的加减操作，可以更快地，同步地完成。</p><p>&quot;light_schema_change&quot; = &#39;true&#39;</p><p>该功能在 2.0.0 及之后版本默认开启。</p></li><li><p>disable_auto_compaction</p><p>是否对这个表禁用自动 Compaction。</p><p>如果这个属性设置成 true, 后台的自动 Compaction 进程会跳过这个表的所有 Tablet。</p><p>&quot;disable_auto_compaction&quot; = &quot;false&quot;</p></li><li><p>enable_single_replica_compaction</p><p>是否对这个表开启单副本 Compaction。</p><p>如果这个属性设置成 true, 这个表的 Tablet 的所有副本只有一个 do compaction，其他的从该副本拉取 rowset</p><p>&quot;enable_single_replica_compaction&quot; = &quot;false&quot;</p></li><li><p>enable_duplicate_without_keys_by_default</p><p>当配置为 true 时，如果创建表的时候没有指定 Unique、Aggregate 或 Duplicate 时，会默认创建一个没有排序列和前缀索引的 Duplicate 模型的表。</p><p>&quot;enable_duplicate_without_keys_by_default&quot; = &quot;false&quot;</p></li><li><p>skip_write_index_on_load</p><p>是否对这个表开启数据导入时不写索引。</p><p>如果这个属性设置成 true, 数据导入的时候不写索引（目前仅对倒排索引生效），而是在 Compaction 的时候延迟写索引。这样可以避免首次写入和 Compaction 重复写索引的 CPU 和 IO 资源消耗，提升高吞吐导入的性能。</p><p>&quot;skip_write_index_on_load&quot; = &quot;false&quot;</p></li><li><p>compaction_policy</p><p>配置这个表的 Compaction 的合并策略，仅支持配置为 time_series 或者 size_based</p><p>time_series: 当 rowset 的磁盘体积积攒到一定大小时进行版本合并。合并后的 rowset 直接晋升到 base compaction 阶段。在时序场景持续导入的情况下有效降低 compact 的写入放大率</p><p>此策略将使用 time_series_compaction 为前缀的参数调整 Compaction 的执行</p><p>&quot;compaction_policy&quot; = &quot;&quot;</p></li><li><p>group_commit_interval_ms</p><p>配置这个表的 Group Commit 攒批间隔。单位为 ms，默认值为 10000ms，即 10s。</p><p>Group Commit 的下刷时机取决于 group_commit_interval_ms以及group_commit_data_bytes哪个先到设置的值。</p><p>&quot;group_commit_interval_ms&quot; = &quot;10000&quot;</p></li><li><p>group_commit_data_bytes</p><p>配置这个表的 Group Commit 攒批数据大小。单位为 bytes，默认值为 134217728 bytes，即 128MB。</p><p>Group Commit 的下刷时机取决于 group_commit_interval_ms以及group_commit_data_bytes 哪个先到设置的值。</p><p>&quot;group_commit_data_bytes&quot; = &quot;134217728&quot;</p></li><li><p>time_series_compaction_goal_size_mbytes</p><p>Compaction 的合并策略为 time_series 时，将使用此参数来调整每次 Compaction 输入的文件的大小，输出的文件大小和输入相当</p><p>&quot;time_series_compaction_goal_size_mbytes&quot; = &quot;1024&quot;</p></li><li><p>time_series_compaction_file_count_threshold</p><p>Compaction 的合并策略为 time_series 时，将使用此参数来调整每次 Compaction 输入的文件数量的最小值</p><p>一个 Tablet 中，文件数超过该配置，就会触发 Compaction</p><p>&quot;time_series_Compaction_file_count_threshold&quot; = &quot;2000&quot;</p></li><li><p>time_series_Compaction_time_threshold_seconds</p><p>Compaction 的合并策略为 time_series 时，将使用此参数来调整 Compaction 的最长时间间隔，即长时间未执行过 Compaction 时，就会触发一次 Compaction，单位为秒</p><p>&quot;time_series_compaction_time_threshold_seconds&quot; = &quot;3600&quot;</p></li><li><p>time_series_compaction_level_threshold</p><p>Compaction 的合并策略为 time_series 时，此参数默认为 1，当设置为 2 时用来控住对于合并过一次的段再合并一层，保证段大小达到 time_series_compaction_goal_size_mbytes，</p><p>能达到段数量减少的效果。</p><p>&quot;time_series_compaction_level_threshold&quot; = &quot;2&quot;</p></li><li><p>enable_mow_light_delete</p><p>是否在 Unique 表 Mow 上开启 Delete 语句写 Delete predicate。若开启，会提升 Delete 语句的性能，但 Delete 后进行部分列更新可能会出现部分数据错误的情况。若关闭，会降低 Delete 语句的性能来保证正确性。</p><p>此属性的默认值为 false。此属性只能在 Unique Merge-on-Write 表上开启。</p><p>&quot;enable_mow_light_delete&quot; = &quot;true&quot;</p></li><li><p>动态分区相关</p><p>动态分区相关参考数据划分 - 动态分区</p></li></ul><blockquote><p>enable_duplicate_without_keys_by_default：生成建表 sql 时可以使用此配置，避免没有指定排序字段而无法建表</p></blockquote><h4 id="样例" tabindex="-1"><a class="header-anchor" href="#样例"><span>样例</span></a></h4><p>创建一个明细模型的表，在不指定 keys_type 时，默认创建一个以表的前三个字段作为 DUPLICATE KEY 的表</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#81A1C1;">CREATE</span><span style="color:#81A1C1;"> TABLE</span><span style="color:#88C0D0;"> example_db</span><span style="color:#D8DEE9FF;">.table_hash</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    k1 </span><span style="color:#81A1C1;">TINYINT</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    k2 </span><span style="color:#81A1C1;">DECIMAL</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10</span><span style="color:#D8DEE9FF;">, </span><span style="color:#B48EAD;">2</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">DEFAULT</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">10.5</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    k3 </span><span style="color:#81A1C1;">CHAR</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10</span><span style="color:#D8DEE9FF;">) COMMENT </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">string column</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    k4 </span><span style="color:#81A1C1;">INT</span><span style="color:#81A1C1;"> NOT NULL</span><span style="color:#81A1C1;"> DEFAULT</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;"> COMMENT </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">int column</span><span style="color:#ECEFF4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">COMMENT </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my first table</span><span style="color:#ECEFF4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">DISTRIBUTED</span><span style="color:#81A1C1;"> BY</span><span style="color:#81A1C1;"> HASH</span><span style="color:#D8DEE9FF;">(k1) BUCKETS </span><span style="color:#B48EAD;">32</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">PROPERTIES (</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#A3BE8C;">replication_num</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1</span><span style="color:#ECEFF4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">//</span><span style="color:#D8DEE9FF;"> 最终的 DDL 语句</span></span></span>
<span class="line"><span class="line"><span style="color:#616E88;">-- example_db.table_hash definition</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">CREATE</span><span style="color:#81A1C1;"> TABLE</span><span style="color:#D8DEE9FF;"> \`</span><span style="color:#88C0D0;">table_hash</span><span style="color:#D8DEE9FF;">\` (</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  \`</span><span style="color:#A3BE8C;">k1</span><span style="color:#ECEFF4;">\`</span><span style="color:#81A1C1;"> tinyint</span><span style="color:#81A1C1;"> NULL</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  \`</span><span style="color:#A3BE8C;">k2</span><span style="color:#ECEFF4;">\`</span><span style="color:#81A1C1;"> decimal</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10</span><span style="color:#D8DEE9FF;">,</span><span style="color:#B48EAD;">2</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">NULL</span><span style="color:#81A1C1;"> DEFAULT</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">10.5</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  \`</span><span style="color:#A3BE8C;">k3</span><span style="color:#ECEFF4;">\`</span><span style="color:#81A1C1;"> char</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">NULL</span><span style="color:#D8DEE9FF;"> COMMENT </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">string column</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  \`</span><span style="color:#A3BE8C;">k4</span><span style="color:#ECEFF4;">\`</span><span style="color:#81A1C1;"> int</span><span style="color:#81A1C1;"> NOT NULL</span><span style="color:#81A1C1;"> DEFAULT</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;"> COMMENT </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">int column</span><span style="color:#ECEFF4;">&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">) ENGINE</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">OLAP</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">DUPLICATE </span><span style="color:#81A1C1;">KEY</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">\`</span><span style="color:#A3BE8C;">k1</span><span style="color:#ECEFF4;">\`</span><span style="color:#D8DEE9FF;">, </span><span style="color:#ECEFF4;">\`</span><span style="color:#A3BE8C;">k2</span><span style="color:#ECEFF4;">\`</span><span style="color:#D8DEE9FF;">, </span><span style="color:#ECEFF4;">\`</span><span style="color:#A3BE8C;">k3</span><span style="color:#ECEFF4;">\`</span><span style="color:#D8DEE9FF;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">COMMENT </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">my first table</span><span style="color:#ECEFF4;">&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">DISTRIBUTED</span><span style="color:#81A1C1;"> BY</span><span style="color:#81A1C1;"> HASH</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">\`</span><span style="color:#A3BE8C;">k1</span><span style="color:#ECEFF4;">\`</span><span style="color:#D8DEE9FF;">) BUCKETS </span><span style="color:#B48EAD;">32</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">PROPERTIES (</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">replication_allocation</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">tag.location.default: 1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">min_load_replica_num</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">-1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">is_being_synced</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">false</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">storage_medium</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">hdd</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">storage_format</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">V2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">inverted_index_storage_format</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">V1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">light_schema_change</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">true</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">disable_auto_compaction</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">false</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">enable_single_replica_compaction</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">false</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">group_commit_interval_ms</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">10000</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">group_commit_data_bytes</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">134217728</span><span style="color:#ECEFF4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">);</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="create-tabke-like" tabindex="-1"><a class="header-anchor" href="#create-tabke-like"><span>CREATE TABKE LIKE</span></a></h3><p>创建一个表结构和另一张表完全相同的空表，同时也能够可选复制一些 rollup</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#81A1C1;">CREATE</span><span style="color:#D8DEE9FF;"> [EXTERNAL] </span><span style="color:#81A1C1;">TABLE</span><span style="color:#D8DEE9FF;"> [IF NOT EXISTS] [database.]table_name </span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">LIKE</span><span style="color:#D8DEE9FF;"> </span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">[database.]table_name [WITH ROLLUP (r1,r2,r3,...)]</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>复制的表结构包括 Column Definition、Partitions、Table Properties 等</li><li>用户需要对复制的原表有<code>SELECT</code>权限</li><li>支持复制 MySQL 等外表</li><li>支持复制 OLAP Table 的 rollup</li></ul><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#81A1C1;">CREATE</span><span style="color:#81A1C1;"> TABLE</span><span style="color:#88C0D0;"> test2</span><span style="color:#D8DEE9FF;">.table2 </span><span style="color:#81A1C1;">LIKE</span><span style="color:#D8DEE9FF;"> test1.table1 </span><span style="color:#81A1C1;">WITH</span><span style="color:#81A1C1;"> ROLLUP</span><span style="color:#D8DEE9FF;"> (r1,r2)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="create-table-as-select" tabindex="-1"><a class="header-anchor" href="#create-table-as-select"><span>CREATE TABLE AS SELECT</span></a></h3><p>通过 Select 语句返回值创建表结构，同时导入数据</p><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#81A1C1;">CREATE</span><span style="color:#81A1C1;"> TABLE</span><span style="color:#88C0D0;"> table_name</span><span style="color:#D8DEE9FF;"> [( column_name_list )]</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    opt_engine:engineName</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    opt_keys:keys</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    opt_comment:tableComment</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    opt_partition:</span><span style="color:#81A1C1;">partition</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    opt_distribution:</span><span style="color:#81A1C1;">distribution</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    opt_rollup:</span><span style="color:#81A1C1;">index</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    opt_properties:tblProperties</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    opt_ext_properties:extProperties</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">    KW_AS query_stmt:query_def</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>用户需要拥有来源表的<code>SELECT</code>权限和目标库的<code>CREATE</code>权限</li><li>创建表成功后，会进行数据导入，如果导入失败，将会删除表</li><li>可以自行指定 key type，默认为<code>Duplicate Key</code></li><li>所有字符串类型的列 (varchar/var/string) 都会被创建为 string 类型。</li><li>如果创建的来源为外部表，并且第一列为 String 类型，则会自动将第一列设置为 VARCHAR(65533)。因为 Doris 内部表，不允许 String 列作为第一列。</li></ul><div class="language-sql line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-sql;"><code><span class="line"><span class="line"><span style="color:#81A1C1;">create</span><span style="color:#81A1C1;"> table</span><span style="color:#D8DEE9FF;"> \`</span><span style="color:#88C0D0;">test</span><span style="color:#D8DEE9FF;">\`.</span><span style="color:#ECEFF4;">\`</span><span style="color:#A3BE8C;">select_name</span><span style="color:#ECEFF4;">\`</span><span style="color:#D8DEE9FF;">(user, testname, userstatus) </span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF;">	PROPERTIES(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">replication_num</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">select</span><span style="color:#D8DEE9FF;"> vt.userId, vt.username, jt.status </span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1;">	from</span><span style="color:#ECEFF4;"> \`</span><span style="color:#A3BE8C;">test</span><span style="color:#ECEFF4;">\`</span><span style="color:#D8DEE9FF;">.</span><span style="color:#ECEFF4;">\`</span><span style="color:#A3BE8C;">varchar_table</span><span style="color:#ECEFF4;">\`</span><span style="color:#D8DEE9FF;"> vt </span><span style="color:#81A1C1;">join</span><span style="color:#D8DEE9FF;"> </span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4;">	\`</span><span style="color:#A3BE8C;">test</span><span style="color:#ECEFF4;">\`</span><span style="color:#D8DEE9FF;">.</span><span style="color:#ECEFF4;">\`</span><span style="color:#A3BE8C;">join_table</span><span style="color:#ECEFF4;">\`</span><span style="color:#D8DEE9FF;"> jt </span><span style="color:#81A1C1;">on</span><span style="color:#D8DEE9FF;"> vt.userId</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">jt.userId</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,56)]))}const c=n(p,[["render",o],["__file","表设计.html.vue"]]),r=JSON.parse('{"path":"/md/article/database/doris/%E8%A1%A8%E8%AE%BE%E8%AE%A1.html","title":"Doris 表设计","lang":"en-US","frontmatter":{"title":"Doris 表设计","sidebar":"heading"},"headers":[{"level":2,"title":"建表基础","slug":"建表基础","link":"#建表基础","children":[{"level":3,"title":"CREATE TABLE","slug":"create-table","link":"#create-table","children":[]},{"level":3,"title":"CREATE TABKE LIKE","slug":"create-tabke-like","link":"#create-tabke-like","children":[]},{"level":3,"title":"CREATE TABLE AS SELECT","slug":"create-table-as-select","link":"#create-table-as-select","children":[]}]}],"git":{"updatedTime":1510891200000,"contributors":[{"name":"hyfly233","username":"hyfly233","email":"hyfly233@outlook.com","commits":1,"url":"https://github.com/hyfly233"}]},"filePathRelative":"md/article/database/doris/表设计.md"}');export{c as comp,r as data};
