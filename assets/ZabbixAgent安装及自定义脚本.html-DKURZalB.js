import{_ as e,c as a,f as n,o as l}from"./app-chPKMbRn.js";const i={};function r(t,s){return l(),a("div",null,s[0]||(s[0]=[n(`<h2 id="rpm-下载地址" tabindex="-1"><a class="header-anchor" href="#rpm-下载地址"><span>RPM 下载地址</span></a></h2><p><a href="https://mirrors.aliyun.com/zabbix/zabbix/5.0/rhel/6/x86_64/?spm=a2c6h.25603864.0.0.2e235942vUkIKa" target="_blank" rel="noopener noreferrer">https://mirrors.aliyun.com/zabbix/zabbix/5.0/rhel/6/x86_64/?spm=a2c6h.25603864.0.0.2e235942vUkIKa</a></p><ul><li><a href="https://mirrors.aliyun.com/zabbix/zabbix/5.0/rhel/6/x86_64/zabbix-agent-5.0.40-1.el6.x86_64.rpm" target="_blank" rel="noopener noreferrer">zabbix-agent-5.0.40-1.el6.x86_64.rpm</a></li><li><a href="https://mirrors.aliyun.com/zabbix/zabbix/5.0/rhel/6/x86_64/zabbix-agent2-5.0.40-1.el6.x86_64.rpm" target="_blank" rel="noopener noreferrer">zabbix-agent2-5.0.40-1.el6.x86_64.rpm</a></li></ul><h2 id="自定义脚本" tabindex="-1"><a class="header-anchor" href="#自定义脚本"><span>自定义脚本</span></a></h2><p>使用自定义脚本采集数据时，可能需要 root 权限，所以需要将 zabbix 修改为以 root 用户运行</p><ul><li>脚本名称：custom_script.sh</li><li>脚本存放地址：/usr/local/bin/</li></ul><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-bash;"><code><span class="line"><span class="line"><span style="color:#88C0D0;">mv</span><span style="color:#A3BE8C;"> custom_script.sh</span><span style="color:#A3BE8C;"> /usr/local/bin/</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0;">chmod</span><span style="color:#B48EAD;"> 777</span><span style="color:#A3BE8C;"> custom_script.sh</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="zabbix-agent" tabindex="-1"><a class="header-anchor" href="#zabbix-agent"><span>Zabbix Agent</span></a></h2><ol><li>配置 zabbix_agent.conf <ol><li>编辑 zabbix_agent.conf</li></ol></li></ol><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-bash;"><code><span class="line"><span class="line"><span style="color:#88C0D0;">vim</span><span style="color:#A3BE8C;"> /etc/zabbix/zabbix_agent.conf</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><pre><code>2. 修改如下内容
</code></pre><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-bash;"><code><span class="line"><span class="line"><span style="color:#D8DEE9;">Server</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">50.100.151.29</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9;">StartAgents</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">0</span><span style="color:#616E88;">  # 设置 StartAgents 为 0</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9;">ServerActive</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">50.100.151.29</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#616E88;"># Hostname=Zabbix server  # 注释掉 Hostname</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9;">HostMetadata</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">CustomHostMetadata</span><span style="color:#616E88;">  # 新增 HostMetadata</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#616E88;"># 新增自定义脚本</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9;">UserParameter</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">custom.script.name,/bin/bash</span><span style="color:#88C0D0;"> /usr/local/bin/custom_script.sh</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>修改 zabbix-agent.service <ol><li>编辑 zabbix-agent.service</li></ol></li></ol><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-bash;"><code><span class="line"><span class="line"><span style="color:#88C0D0;">vim</span><span style="color:#A3BE8C;"> /usr/lib/systemd/system/zabbix-agent.service</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><pre><code>2. 修改如下内容
</code></pre><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-bash;"><code><span class="line"><span class="line"><span style="color:#D8DEE9;">User</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">root</span><span style="color:#616E88;">      # 将原先的 zabbix 修改为 root</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9;">Group</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">root</span><span style="color:#616E88;">     # 将原先的 zabbix 修改为 root</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>设置 zabbix-agent 为开机自启</li></ol><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-bash;"><code><span class="line"><span class="line"><span style="color:#88C0D0;">systemctl</span><span style="color:#A3BE8C;"> enable</span><span style="color:#A3BE8C;"> zabbix-agent</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="zabbix-agent2" tabindex="-1"><a class="header-anchor" href="#zabbix-agent2"><span>Zabbix Agent2</span></a></h2><ol><li>配置 zabbix_agent2.conf <ol><li>编辑 zabbix_agent2.conf</li></ol></li></ol><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-bash;"><code><span class="line"><span class="line"><span style="color:#88C0D0;">vim</span><span style="color:#A3BE8C;"> /etc/zabbix/zabbix_agent2.conf</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><pre><code>2. 修改如下内容
</code></pre><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-bash;"><code><span class="line"><span class="line"><span style="color:#D8DEE9;">Server</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">50.100.151.29</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9;">ServerActive</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">50.100.151.29</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#616E88;"># Hostname=Zabbix server  # 注释掉 Hostname</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9;">HostMetadata</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">CustomHostMetadata</span><span style="color:#616E88;">  # 新增 HostMetadata</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#616E88;"># 新增自定义脚本</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9;">UserParameter</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">custom.script.name,/bin/bash</span><span style="color:#88C0D0;"> /usr/local/bin/custom_script.sh</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>修改 zabbix-agent2.service <ol><li>编辑 zabbix-agent2.service</li></ol></li></ol><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-bash;"><code><span class="line"><span class="line"><span style="color:#88C0D0;">vim</span><span style="color:#A3BE8C;"> /usr/lib/systemd/system/zabbix-agent2.service</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><pre><code>2. 修改如下内容
</code></pre><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-bash;"><code><span class="line"><span class="line"><span style="color:#D8DEE9;">User</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">root</span><span style="color:#616E88;">      # 将原先的 zabbix 修改为 root</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9;">Group</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">root</span><span style="color:#616E88;">     # 将原先的 zabbix 修改为 root</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>设置 zabbix-agent2 为开机自启</li></ol><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff language-bash;"><code><span class="line"><span class="line"><span style="color:#88C0D0;">systemctl</span><span style="color:#A3BE8C;"> enable</span><span style="color:#A3BE8C;"> zabbix-agent2</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,29)]))}const o=e(i,[["render",r],["__file","ZabbixAgent安装及自定义脚本.html.vue"]]),d=JSON.parse('{"path":"/md/article/monitor/zabbix/ZabbixAgent%E5%AE%89%E8%A3%85%E5%8F%8A%E8%87%AA%E5%AE%9A%E4%B9%89%E8%84%9A%E6%9C%AC.html","title":"ZabbixAgent安装及自定义脚本","lang":"en-US","frontmatter":{"title":"ZabbixAgent安装及自定义脚本","sidebar":"heading"},"headers":[{"level":2,"title":"RPM 下载地址","slug":"rpm-下载地址","link":"#rpm-下载地址","children":[]},{"level":2,"title":"自定义脚本","slug":"自定义脚本","link":"#自定义脚本","children":[]},{"level":2,"title":"Zabbix Agent","slug":"zabbix-agent","link":"#zabbix-agent","children":[]},{"level":2,"title":"Zabbix Agent2","slug":"zabbix-agent2","link":"#zabbix-agent2","children":[]}],"git":{"updatedTime":1735987286000,"contributors":[{"name":"hyfly233","username":"hyfly233","email":"hyfly233@outlook.com","commits":1,"url":"https://github.com/hyfly233"}]},"filePathRelative":"md/article/monitor/zabbix/ZabbixAgent安装及自定义脚本.md"}');export{o as comp,d as data};
